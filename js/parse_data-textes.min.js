function handleInput(e){var t=document.getElementById("recherche_dans_le_sujet"),s=t.value.toLowerCase();this.timer&&window.clearTimeout(this.timer),this.timer=window.setTimeout(function(){if(s.length>2){searchItems=s.split("+"),tableBody="<tbody>",rows.forEach(e=>{cellules=e[0].split("\t"),source=cellules.toString().toLowerCase(),checker(source,searchItems)&&(scorePertinence=0,searchItems.forEach(e=>{regex=new RegExp("\\b"+e+"\\b|\\b"+e+"s\\b","gi"),nombreOccurrencesTexte=cellules[2].toLowerCase().split(e).length-1,nombreOccurrencesTextePerfectMatch=2*(cellules[2].toLowerCase().match(regex)||[]).length,scorePertinence+=2*(nombreOccurrencesTexte+nombreOccurrencesTextePerfectMatch),nombreOccurrencesAuteur=cellules[0].toLowerCase().split(e).length-1,nombreOccurrencesAuteurPerfectMatch=2*(cellules[0].toLowerCase().match(regex)||[]).length,scorePertinence+=4*(nombreOccurrencesAuteur+nombreOccurrencesAuteurPerfectMatch),cellules[3]&&(nombreOccurrencesPrecisions=cellules[3].toLowerCase().split(e).length-1,scorePertinence+=nombreOccurrencesPrecisions),cellules[1]&&(nombreOccurrencesReference=cellules[1].toLowerCase().split(e).length-1,scorePertinence+=nombreOccurrencesReference)}),texte="« "+cellules[2]+" »",tableBody+="<tr>",auteur="<br/><b>"+cellules[0]+"</b>",cellules[1]?reference=", "+cellules[1]:reference="",cellules[3]?precisions="<br/>"+cellules[3]:precisions="",cellules[4]?c1='<td><span class="tooltip">'+cellules[4]+'<span class="tooltiptext">Éthique et philosophie morale</span></span></td>':c1="<td></td>",cellules[5]?c2='<td><span class="tooltip">'+cellules[5]+'<span class="tooltiptext">Philosophie de l\'esprit</span></span></td>':c2="<td></td>",cellules[6]?c3='<td><span class="tooltip">'+cellules[6]+'<span class="tooltiptext">Philosophie de la culture</span></span></td>':c3="<td></td>",cellules[7]?c4='<td><span class="tooltip">'+cellules[7]+'<span class="tooltiptext">Philosophie sociale et politique</span></span></td>':c4="<td></td>",cellules[8]?c5='<td><span class="tooltip">'+cellules[8]+'<span class="tooltiptext">Épistémologie et métaphysique</span></span></td>':c5="<td></td>",cellules[9]?c6='<td><span class="tooltip">'+cellules[9]+'<span class="tooltiptext">Philosophie du langage</span></span></td>':c6="<td></td>",tableBody=tableBody+"<td>"+auteur+"</td><td>"+texte+auteur+reference+precisions+"</td><td>"+scorePertinence+"</td>"+c1+c2+c3+c4+c5+c6,tableBody+="</tr>")}),tableBody+="</tbody>",document.getElementsByTagName("tbody")[0].innerHTML=tableBody;var e=document.getElementById("content");i_search=1,searchItems.forEach(t=>{var s=new Mark(e);s.mark(t,options={element:"span",className:"match"+i_search,accuracy:"complementary",separateWordSearch:!1}),i_search+=1}),fdTableSort.init("textes"),fdTableSort.jsWrapper("textes",[2,0])}else document.getElementsByTagName("tbody")[0].innerHTML=tableBodyStart},350)}var rows,allResults,title,content,tableBody,tableBodyStart=document.getElementsByTagName("tbody")[0].innerHTML,urls=["https://raw.githubusercontent.com/eyssette/textes-philo/main/data/textes-FINAL.tsv","https://raw.githubusercontent.com/eyssette/textes-philo/main/data/textes-new.tsv"];Promise.all(urls.map(e=>new Promise((t,s)=>Papa.parse(e,{download:!0,header:!1,delimiter:"    ",complete:t,error:s})))).then(function(e){rows=e[0].data;for(let t=1;t<urls.length;t++)rows=rows.concat(e[t].data);rows=rows.splice(1,rows.length)}).catch(e=>console.warn("Something went wrong:",e));var boutonRecherche=document.getElementById("rechercher");boutonRecherche.onclick=handleInput;let checker=(e,t)=>t.every(t=>e.includes(t));