!function(){fdTableSort={regExp_Currency:/^[Â£$â‚¬Â¥Â¤]/,regExp_Number:/^(\-)?[0-9]+(\.[0-9]*)?$/,pos:-1,uniqueHash:1,thNode:null,tableId:null,tableCache:{},tmpCache:{},sortActiveClass:"sort-active",colspan:"colspan",rowspan:"rowspan",addEvent:function(e,a,t,l){e.attachEvent?(e["e"+a+t]=t,e[a+t]=function(){e["e"+a+t](window.event)},e.attachEvent("on"+a,e[a+t])):e.addEventListener(a,t,!0)},removeEvent:function(e,a,t,l){try{e.detachEvent?(e.detachEvent("on"+a,e[a+t]),e[a+t]=null):e.removeEventListener(a,t,!0)}catch(e){}},stopEvent:function(e){return(e=e||window.event).stopPropagation&&(e.stopPropagation(),e.preventDefault()),!1},parseClassName:function(e,a){a=a.className.match(new RegExp(e+"((-[\\d]+([r]){0,1})+)"));return a&&a.length?a[0].replace(e,"").split("-"):[]},disableSelection:function(e){e.onselectstart=function(){return!1},e.unselectable="on",e.style.MozUserSelect="none"},removeTableCache:function(e){if(e in fdTableSort.tableCache){fdTableSort.tableCache[e]=null,delete fdTableSort.tableCache[e];e=document.getElementById(e);if(e)for(var a,t,l=e.getElementsByTagName("th"),r=0;t=l[r];r++)(a=t.getElementsByTagName("a")).length&&(a[0].onkeydown=a[0].onclick=null),t.onclick=t.onselectstart=t=a=null}},removeTmpCache:function(e){if(e in fdTableSort.tmpCache){for(var a,t,l=fdTableSort.tmpCache[e].headers,r=0;t=l[r];r++)for(var o,d=0;o=t[d];d++)(a=o.getElementsByTagName("a")).length&&(a[0].onkeydown=a[0].onclick=null),o.onclick=o.onselectstart=o=a=null;fdTableSort.tmpCache[e]=null,delete fdTableSort.tmpCache[e]}},initEvt:function(e){fdTableSort.init(!1)},init:function(e){if(document.getElementsByTagName&&document.createElement&&document.getElementById){var a,t,l,r,o,d,s,n,c,b,i,f,h,m,S,T,N,p,g,u,v=e&&document.getElementById(e)?[document.getElementById(e)]:document.getElementsByTagName("table"),C=document.createElement("a");C.href="#",C.className="fdTableSortTrigger";for(var w,y=document.createElement("span"),E=0;w=v[E];E++){w.id&&(fdTableSort.removeTableCache(w.id),fdTableSort.removeTmpCache(w.id)),m=(w.getElementsByTagName("thead").length?w.getElementsByTagName("thead")[0]:w).getElementsByTagName("tr"),T=!(S=[]);for(var k,A=0;k=m[A];A++)if(!k.getElementsByTagName("td").length&&k.getElementsByTagName("th").length){S[S.length]=k.getElementsByTagName("th");for(var j,I=0;j=S[S.length-1][I];I++)-1!=j.className.search(/sortable/)&&(T=!0)}if(T){for(w.id||(w.id="fd-table-"+fdTableSort.uniqueHash++),s=-1==w.className.search("no-arrow"),o=-1!=w.className.search("sortable-onload-show"),n={},r=fdTableSort.parseClassName(o?"sortable-onload-show":"sortable-onload",w),d=1;d<r.length;d++)n[parseInt(r[d],10)]={reverse:-1!=r[d].search("r")};for(u=S[0].length,a=0;a<S[0].length;a++)S[0][a].getAttribute(fdTableSort.colspan)&&1<S[0][a].getAttribute(fdTableSort.colspan)&&(u+=S[0][a].getAttribute(fdTableSort.colspan)-1);for(b=new Array(S.length),a=S.length;a--;)b[a]=new Array(u);for(a=0;a<b.length;a++)for(A=N=0;A<u;A++)if(!b[a][A]){p=1<(h=S[a][N]).getAttribute(fdTableSort.colspan)?h.getAttribute(fdTableSort.colspan):1,g=1<h.getAttribute(fdTableSort.rowspan)?h.getAttribute(fdTableSort.rowspan):1;for(var x=0;x<p&&A+x<u;x++)for(var B=0;B<g&&a+B<b.length;B++)b[a+B][A+x]=h;if(++N==S[a].length)break}for(a=0;a<b.length;a++)for(A=0;A<b[a].length;A++)if(-1==b[a][A].className.search("fd-column-")&&-1!=b[a][A].className.search("sortable")&&(b[a][A].className=b[a][A].className+" fd-column-"+A),b[a][A].className.match("sortable")){b[a][A].className=b[a][A].className.replace(/forwardSort|reverseSort/,""),A in n&&(n[A].thNode=b[a][A],n.active=!0),i=fdTableSort.getInnerText(b[a][A],!0);for(var O=b[a][A].childNodes.length;O--;)1==b[a][A].childNodes[O].nodeType&&("fdFilterTrigger"==b[a][A].childNodes[O].className||/img/i.test(b[a][A].childNodes[O].nodeName))||(1==b[a][A].childNodes[O].nodeType&&/^a$/i.test(b[a][A].childNodes[O].nodeName)&&(b[a][A].childNodes[O].onclick=b[a][A].childNodes[O].onkeydown=null),b[a][A].removeChild(b[a][A].childNodes[O]));(f=C.cloneNode(!0)).innerHTML=i,f.title="Sort on “"+i.replace("<br />","")+"”",f.onclick=f.onkeydown=b[a][A].onclick=fdTableSort.initWrapper,b[a][A].appendChild(f),s&&b[a][A].appendChild(y.cloneNode(!1)),b[a][A].className=b[a][A].className.replace(/fd-identical|fd-not-identical/,""),fdTableSort.disableSelection(b[a][A]),f=null}if(fdTableSort.tmpCache[w.id]={cols:u,headers:b},b=null,"active"in n){for(col in fdTableSort.tableId=w.id,fdTableSort.prepareTableData(document.getElementById(fdTableSort.tableId)),delete n.active,n)if("thNode"in(c=n[col])){for(fdTableSort.multi=!0,l=c.reverse?2:1,t=0;t<l;t++)fdTableSort.thNode=c.thNode,o?fdTableSort.addThNode():fdTableSort.initSort(!1,!0);o&&(fdTableSort.removeClass(c.thNode,"(forwardSort|reverseSort)"),fdTableSort.addClass(c.thNode,c.reverse?"reverseSort":"forwardSort"),s&&((y=fdTableSort.thNode.getElementsByTagName("span")[0]).firstChild&&y.removeChild(y.firstChild),y.appendChild(document.createTextNode(1==l?" ↓":" ↑"))))}o&&(fdTableSort.tableCache[w.id].colStyle||fdTableSort.tableCache[w.id].rowStyle)&&fdTableSort.redraw(w.id,!1)}else-1!=w.className.search(/onload-zebra/)&&(fdTableSort.tableId=w.id,fdTableSort.prepareTableData(w),fdTableSort.tableCache[w.id].rowStyle&&fdTableSort.redraw(w.id,!1))}}fdTableSort.thNode=f=C=y=n=thNode=w=m=S=null}},initWrapper:function(e){var a="keydown"==(e=e||window.event).type?null!=e.keyCode?e.keyCode:e.charCode:-1;if(null!=fdTableSort.thNode||"click"!=e.type&&13!=a)return-1!=a||fdTableSort.stopEvent(e);for(var t=this;"th"!=t.tagName.toLowerCase();)t=t.parentNode;for(fdTableSort.thNode=t;"table"!=t.tagName.toLowerCase();)t=t.parentNode;return fdTableSort.tableId=t.id,fdTableSort.multi=e.shiftKey,fdTableSort.addSortActiveClass(),setTimeout(fdTableSort.initSort,5,!1),fdTableSort.stopEvent(e)},jsWrapper:function(e,a){if(!(e in fdTableSort.tmpCache))return!1;e in fdTableSort.tableCache||fdTableSort.prepareTableData(document.getElementById(e)),a instanceof Array||(a=[a]),fdTableSort.tableId=e;var t,l=a.length;if(fdTableSort.tableCache[e].thList.length==a.length){for(var r,o=!0,d=0;d<l;d++)if(t=a[d],(r=fdTableSort.tmpCache[e].headers[0][t])!=fdTableSort.tableCache[e].thList[d]){o=!1;break}if(o)return fdTableSort.thNode=r,void fdTableSort.initSort(!0)}for(fdTableSort.addSortActiveClass(),d=0;d<l;d++)t=a[fdTableSort.multi=d],fdTableSort.thNode=fdTableSort.tmpCache[e].headers[0][t],fdTableSort.initSort(!0)},addSortActiveClass:function(){null!=fdTableSort.thNode&&(fdTableSort.addClass(fdTableSort.thNode,fdTableSort.sortActiveClass),fdTableSort.addClass(document.getElementsByTagName("body")[0],fdTableSort.sortActiveClass))},removeSortActiveClass:function(){null!=fdTableSort.thNode&&(fdTableSort.removeClass(fdTableSort.thNode,fdTableSort.sortActiveClass),fdTableSort.removeClass(document.getElementsByTagName("body")[0],fdTableSort.sortActiveClass))},doCallback:function(e){fdTableSort.tableId&&fdTableSort.tableId in fdTableSort.tableCache&&fdTableSort.callback(fdTableSort.tableId,e?fdTableSort.tableCache[fdTableSort.tableId].initiatedCallback:fdTableSort.tableCache[fdTableSort.tableId].completeCallback)},addClass:function(e,a){new RegExp("(^|\\s)"+a+"(\\s|$)").test(e.className)||(e.className+=(e.className?" ":"")+a)},removeClass:function(e,a){e.className=a?e.className.replace(new RegExp("(^|\\s)"+a+"(\\s|$)")," ").replace(/^\s\s*/,"").replace(/\s\s*$/,""):""},callback:function(e,a){var t,l;try{if(-1!=a.indexOf(".")){l=a.split("."),obj=window;for(var r,o=0;r=obj[l[o]];o++)r instanceof Function?function(){var a=r;t=function(e){a.apply(obj,[e])}}():obj=r}else t=a+e in window?window[a+e]:a in window?window[a]:null}catch(e){}t instanceof Function&&t(e,fdTableSort.tableCache[e].thList)},prepareTableData:function(e){for(var a,t,l,r,o,d,s=[],n=e.getElementsByTagName("tbody"),c=(n=n.length?n[0]:e).rows,b=e.getElementsByTagName("th"),i=c.length,f=fdTableSort.tmpCache[e.id].cols,h=(s=[],new Array(f)),m=new Array(f),S=0;S<f;S++)h[S]=!0;for(var T,N=new RegExp(/fd-column-([0-9]+)/),p=0,g=[],S=0;T=b[S];S++)-1!=T.className.search(N)&&(g[g.length]=T);for(d=0;d<i;d++)if(!((a=c[d]).parentNode!=n||a.getElementsByTagName("th").length||a.parentNode&&-1!=a.parentNode.tagName.toLowerCase().search(/thead|tfoot/))){for(s[p]=[],r=a.cells,S=0;T=g[S];S++)t=r[o=T.className.match(N)[1]],l=(l=fdTableSort.getInnerText(t)+" ").replace(/^\s+/,"").replace(/\s+$/,""),-1!=T.className.search(/sortable-date/)?l=fdTableSort.dateFormat(l,-1!=T.className.search(/sortable-date-dmy/)):-1!=T.className.search(/sortable-numeric|sortable-currency/)?(l=parseFloat(l.replace(/[^0-9\.\-]/g,"")),isNaN(l)&&(l="")):-1!=T.className.search(/sortable-text/)?l=l.toLowerCase():-1!=T.className.search(/sortable-keep/)?l=p:-1!=T.className.search(/sortable-([a-zA-Z\_]+)/)?T.className.match(/sortable-([a-zA-Z\_]+)/)[1]+"PrepareData"in window&&(l=window[T.className.match(/sortable-([a-zA-Z\_]+)/)[1]+"PrepareData"](t,l)):""!=l&&(fdTableSort.removeClass(T,"sortable"),0!=fdTableSort.dateFormat(l)?(fdTableSort.addClass(T,"sortable-date"),l=fdTableSort.dateFormat(l)):-1!=l.search(fdTableSort.regExp_Number)||-1!=l.search(fdTableSort.regExp_Currency)?(fdTableSort.addClass(T,"sortable-numeric"),l=parseFloat(l.replace(/[^0-9\.\-]/g,"")),isNaN(l)&&(l="")):(fdTableSort.addClass(T,"sortable-text"),l=l.toLowerCase())),0<p&&h[o]&&m[o]!=l&&(h[o]=!1),m[o]=l,s[p][o]=l;s[p][f]=a,p++}var u=-1!=e.className.search(/colstyle-([\S]+)/)&&e.className.match(/colstyle-([\S]+)/)[1],v=-1!=e.className.search(/rowstyle-([\S]+)/)&&e.className.match(/rowstyle-([\S]+)/)[1],C=-1==e.className.search(/sortinitiatedcallback-([\S-]+)/)?"sortInitiatedCallback":e.className.match(/sortinitiatedcallback-([\S]+)/)[1],w=-1==e.className.search(/sortcompletecallback-([\S-]+)/)?"sortCompleteCallback":e.className.match(/sortcompletecallback-([\S]+)/)[1],C=C.replace("-","."),w=w.replace("-",".");fdTableSort.tableCache[e.id]={hook:n,initiatedCallback:C,completeCallback:w,thList:[],colOrder:{},data:s,identical:h,colStyle:u,rowStyle:v,noArrow:-1!=e.className.search(/no-arrow/)},g=s=a=t=T=c=h=m=null},onUnload:function(){for(tbl in fdTableSort.tableCache)fdTableSort.removeTableCache(tbl);for(tbl in fdTableSort.tmpCache)fdTableSort.removeTmpCache(tbl);fdTableSort.removeEvent(window,"load",fdTableSort.initEvt),fdTableSort.removeEvent(window,"unload",fdTableSort.onUnload),fdTableSort.tmpCache=fdTableSort.tableCache=null},addThNode:function(){var e=fdTableSort.tableCache[fdTableSort.tableId],a=fdTableSort.thNode.className.match(/fd-column-([0-9]+)/)[1],t=!1;if(!fdTableSort.multi){if(e.colStyle)for(var l=e.thList.length,r=0;r<l;r++)e.colOrder[e.thList[r].className.match(/fd-column-([0-9]+)/)[1]]=!1;e.thList.length&&e.thList[0]==fdTableSort.thNode&&(t=!0),e.thList=[]}var o=!1;for(e.thList.length,r=0;n=e.thList[r];r++)if(n==fdTableSort.thNode){o=!0;break}o||(e.thList.push(fdTableSort.thNode),e.colStyle&&(e.colOrder[a]=!0));for(var d,s=document.getElementById(fdTableSort.tableId).getElementsByTagName("th"),r=0;d=s[r];r++){o=!1;for(var n,c=0;n=e.thList[c];c++)if(n==d){o=!0;break}if(!o&&(fdTableSort.removeClass(d,"(forwardSort|reverseSort)"),!e.noArrow&&(span=d.getElementsByTagName("span"),span.length)))for(span=span[0];span.firstChild;)span.removeChild(span.firstChild)}1<e.thList.length?(classToAdd=-1!=fdTableSort.thNode.className.search(/forwardSort/)?"reverseSort":"forwardSort",fdTableSort.removeClass(fdTableSort.thNode,"(forwardSort|reverseSort)"),fdTableSort.addClass(fdTableSort.thNode,classToAdd),e.pos=-1):t&&(e.pos=fdTableSort.thNode)},initSort:function(noCallback,ident){var thNode=fdTableSort.thNode,tableElem=document.getElementById(fdTableSort.tableId);fdTableSort.tableId in fdTableSort.tableCache||fdTableSort.prepareTableData(document.getElementById(fdTableSort.tableId)),fdTableSort.addThNode(),noCallback||fdTableSort.doCallback(!0),fdTableSort.pos=thNode.className.match(/fd-column-([0-9]+)/)[1];var dataObj=fdTableSort.tableCache[tableElem.id],lastPos=dataObj.pos&&dataObj.pos.className?dataObj.pos.className.match(/fd-column-([0-9]+)/)[1]:-1,len1=dataObj.data.length,len2=0<dataObj.data.length?dataObj.data[0].length-1:0,identical=dataObj.identical[fdTableSort.pos],classToAdd="forwardSort",span;if(1<dataObj.thList.length){for(var js="var sortWrapper = function(a,b) {\n",l=dataObj.thList.length,cnt=0,e,d,th,p,f,i=0;i<l;i++)th=dataObj.thList[i],p=th.className.match(/fd-column-([0-9]+)/)[1],dataObj.identical[p]||(cnt++,f=th.className.match(/sortable-(numeric|currency|date|keep)/)?"fdTableSort.sortNumeric":!th.className.match("sortable-text")&&-1!=th.className.search(/sortable-([a-zA-Z\_]+)/)&&th.className.match(/sortable-([a-zA-Z\_]+)/)[1]in window?"window['"+th.className.match(/sortable-([a-zA-Z\_]+)/)[1]+"']":"fdTableSort.sortText",e="e"+i,d=-1!=th.className.search("forwardSort")?"a,b":"b,a",js+="fdTableSort.pos   = "+p+";\n",js+="var "+e+" = "+f+"("+d+");\n",js+="if("+e+") return "+e+";\n",js+="else { \n");js+="return 0;\n";for(var i=0;i<cnt;i++)js+="};\n";cnt&&(js+="return 0;\n"),js+="};\n",eval(js),dataObj.data.sort(sortWrapper),identical=!1}else lastPos==fdTableSort.pos&&!identical||-1!=thNode.className.search(/sortable-keep/)&&-1==lastPos?(dataObj.data.reverse(),classToAdd=-1!=thNode.className.search(/reverseSort/)?"forwardSort":"reverseSort",-1!=thNode.className.search(/sortable-keep/)&&-1==lastPos&&(fdTableSort.tableCache[tableElem.id].pos=thNode)):(fdTableSort.tableCache[tableElem.id].pos=thNode,classToAdd=-1!=thNode.className.search(/forwardSort/)?"reverseSort":"forwardSort",identical||(thNode.className.match(/sortable-(numeric|currency|date|keep)/)?dataObj.data.sort(fdTableSort.sortNumeric):thNode.className.match("sortable-text")?dataObj.data.sort(fdTableSort.sortText):-1!=thNode.className.search(/sortable-([a-zA-Z\_]+)/)&&thNode.className.match(/sortable-([a-zA-Z\_]+)/)[1]in window&&dataObj.data.sort(window[thNode.className.match(/sortable-([a-zA-Z\_]+)/)[1]]),-1!=thNode.className.search(/(^|\s)favour-reverse($|\s)/)&&(classToAdd="forwardSort"==classToAdd?"reverseSort":"forwardSort",dataObj.data.reverse())));if(ident&&(identical=!1),1==dataObj.thList.length&&(fdTableSort.removeClass(thNode,"(forwardSort|reverseSort)"),fdTableSort.addClass(thNode,classToAdd)),dataObj.noArrow||(span=fdTableSort.thNode.getElementsByTagName("span")[0],span.firstChild&&span.removeChild(span.firstChild),span.appendChild(document.createTextNode(-1!=fdTableSort.thNode.className.search(/forwardSort/)?" ↓":" ↑"))),!dataObj.rowStyle&&!dataObj.colStyle&&identical)return fdTableSort.removeSortActiveClass(),noCallback||fdTableSort.doCallback(!1),void(fdTableSort.thNode=null);("tablePaginater"in window&&tablePaginater.tableIsPaginated(fdTableSort.tableId)?tablePaginater:fdTableSort).redraw(fdTableSort.tableId,identical),fdTableSort.removeSortActiveClass(),noCallback||fdTableSort.doCallback(!1),fdTableSort.thNode=null},redraw:function(e,a){if(e&&e in fdTableSort.tableCache){for(var t,l,e=fdTableSort.tableCache[e],r=e.data,o=r.length,d=o?r[0].length-1:0,s=e.hook,n=e.colStyle,c=e.rowStyle,b=e.colOrder,i=0,f=/(^|\s)invisibleRow(\s|$)/,h=0;h<o;h++){if(t=r[h][d],n)for(thPos in l=t.cells,b)b[thPos]?fdTableSort.addClass(l[thPos],n):fdTableSort.removeClass(l[thPos],n);a||(c&&-1==t.className.search(f)&&(1&i++?fdTableSort.addClass(t,c):fdTableSort.removeClass(t,c)),s.appendChild(t))}t=l=s=null}},getInnerText:function(e,a){if("string"==typeof e||void 0===e)return e;if(e.innerText)return e.innerText;for(var t="",l=e.firstChild;l;l=l.nextSibling)a&&l.nodeName&&"BR"==l.nodeName?t+="<br />":3==l.nodeType?t+=l.nodeValue:1==l.nodeType&&(t+=fdTableSort.getInnerText(l));return t},dateFormat:function(e,a){for(var t,l=[{regExp:/^(0?[1-9]|1[012])([- \/.])(0?[1-9]|[12][0-9]|3[01])([- \/.])((\d\d)?\d\d)$/,d:3,m:1,y:5},{regExp:/^(0?[1-9]|[12][0-9]|3[01])([- \/.])(0?[1-9]|1[012])([- \/.])((\d\d)?\d\d)$/,d:1,m:3,y:5},{regExp:/^(\d\d\d\d)([- \/.])(0?[1-9]|1[012])([- \/.])(0?[1-9]|[12][0-9]|3[01])$/,d:5,m:3,y:1}],r=0,o=l.length;r<o;){if(t=(r+(a?o+1:o))%o,e.match(l[t].regExp))return res=e.match(l[t].regExp),y=res[l[t].y],m=res[l[t].m],d=res[l[t].d],1==m.length&&(m="0"+String(m)),1==d.length&&(d="0"+String(d)),4!=y.length&&(y=parseInt(y)<50?"20"+String(y):"19"+String(y)),y+String(m)+d;r++}return 0},sortNumeric:function(e,a){e=e[fdTableSort.pos],a=a[fdTableSort.pos];return e==a?0:""!==e||isNaN(a)?""!==a||isNaN(e)?e-a:1:-1},sortText:function(e,a){e=e[fdTableSort.pos],a=a[fdTableSort.pos];return e==a?0:e<a?-1:1}}}(),fdTableSort.addEvent(window,"load",fdTableSort.initEvt),fdTableSort.addEvent(window,"unload",fdTableSort.onUnload);